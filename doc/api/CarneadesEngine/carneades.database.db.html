<!DOCTYPE html>
<html><head><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>carneades.database.db documentation</title></head><body><div id="header"><h1><a href="index.html">Carneades-engine 2.0.0-SNAPSHOT API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><span>Namespaces</span></h3><ul><li><a href="carneades.config.reader.html"><span>carneades.config.reader</span></a></li><li><a href="carneades.database.admin.html"><span>carneades.database.admin</span></a></li><li class="current"><a href="carneades.database.db.html"><span>carneades.database.db</span></a></li><li><a href="carneades.database.export.html"><span>carneades.database.export</span></a></li><li><a href="carneades.database.import.html"><span>carneades.database.import</span></a></li><li><a href="carneades.engine.argument.html"><span>carneades.engine.argument</span></a></li><li><a href="carneades.engine.argument-builtins.html"><span>carneades.engine.argument-builtins</span></a></li><li><a href="carneades.engine.argument-construction.html"><span>carneades.engine.argument-construction</span></a></li><li><a href="carneades.engine.argument-evaluation.html"><span>carneades.engine.argument-evaluation</span></a></li><li><a href="carneades.engine.argument-generator.html"><span>carneades.engine.argument-generator</span></a></li><li><a href="carneades.engine.argument-graph.html"><span>carneades.engine.argument-graph</span></a></li><li><a href="carneades.engine.ask.html"><span>carneades.engine.ask</span></a></li><li><a href="carneades.engine.aspic.html"><span>carneades.engine.aspic</span></a></li><li><a href="carneades.engine.caes.html"><span>carneades.engine.caes</span></a></li><li><a href="carneades.engine.dialog.html"><span>carneades.engine.dialog</span></a></li><li><a href="carneades.engine.dnf.html"><span>carneades.engine.dnf</span></a></li><li><a href="carneades.engine.dublin-core.html"><span>carneades.engine.dublin-core</span></a></li><li><a href="carneades.engine.dung.html"><span>carneades.engine.dung</span></a></li><li><a href="carneades.engine.policy.html"><span>carneades.engine.policy</span></a></li><li><a href="carneades.engine.sandbox.html"><span>carneades.engine.sandbox</span></a></li><li><a href="carneades.engine.scheme.html"><span>carneades.engine.scheme</span></a></li><li><a href="carneades.engine.search.html"><span>carneades.engine.search</span></a></li><li><a href="carneades.engine.shell.html"><span>carneades.engine.shell</span></a></li><li><a href="carneades.engine.statement.html"><span>carneades.engine.statement</span></a></li><li><a href="carneades.engine.unify.html"><span>carneades.engine.unify</span></a></li><li><a href="carneades.engine.utils.html"><span>carneades.engine.utils</span></a></li><li><a href="carneades.engine.uuid.html"><span>carneades.engine.uuid</span></a></li><li><a href="carneades.maps.format-statement.html"><span>carneades.maps.format-statement</span></a></li><li><a href="carneades.maps.lacij.html"><span>carneades.maps.lacij</span></a></li><li><a href="carneades.maps.lacij-export.html"><span>carneades.maps.lacij-export</span></a></li><li><a href="carneades.maps.lacij-params.html"><span>carneades.maps.lacij-params</span></a></li><li><a href="carneades.maps.subset-ag.html"><span>carneades.maps.subset-ag</span></a></li><li><a href="carneades.xml.caf.export.html"><span>carneades.xml.caf.export</span></a></li><li><a href="carneades.xml.lkif.export.html"><span>carneades.xml.lkif.export</span></a></li><li><a href="carneades.xml.lkif.validator.html"><span>carneades.xml.lkif.validator</span></a></li></ul></div><div class="sidebar" id="vars"><h3>Public Vars</h3><ul><li><a href="carneades.database.db.html#var-assume"><span>assume</span></a></li><li><a href="carneades.database.db.html#var-create-argument"><span>create-argument</span></a></li><li><a href="carneades.database.db.html#var-create-argument-database"><span>create-argument-database</span></a></li><li><a href="carneades.database.db.html#var-create-argument-poll"><span>create-argument-poll</span></a></li><li><a href="carneades.database.db.html#var-create-metadata"><span>create-metadata</span></a></li><li><a href="carneades.database.db.html#var-create-namespace"><span>create-namespace</span></a></li><li><a href="carneades.database.db.html#var-create-premise"><span>create-premise</span></a></li><li><a href="carneades.database.db.html#var-create-statement"><span>create-statement</span></a></li><li><a href="carneades.database.db.html#var-create-statement-poll"><span>create-statement-poll</span></a></li><li><a href="carneades.database.db.html#var-create-translation"><span>create-translation</span></a></li><li><a href="carneades.database.db.html#var-delete-argument"><span>delete-argument</span></a></li><li><a href="carneades.database.db.html#var-delete-argument-poll"><span>delete-argument-poll</span></a></li><li><a href="carneades.database.db.html#var-delete-metadata"><span>delete-metadata</span></a></li><li><a href="carneades.database.db.html#var-delete-namespace"><span>delete-namespace</span></a></li><li><a href="carneades.database.db.html#var-delete-premise"><span>delete-premise</span></a></li><li><a href="carneades.database.db.html#var-delete-statement"><span>delete-statement</span></a></li><li><a href="carneades.database.db.html#var-delete-statement-poll"><span>delete-statement-poll</span></a></li><li><a href="carneades.database.db.html#var-delete-translation"><span>delete-translation</span></a></li><li><a href="carneades.database.db.html#var-get-con-arguments"><span>get-con-arguments</span></a></li><li><a href="carneades.database.db.html#var-get-dependents"><span>get-dependents</span></a></li><li><a href="carneades.database.db.html#var-get-pro-arguments"><span>get-pro-arguments</span></a></li><li><a href="carneades.database.db.html#var-get-rebuttals"><span>get-rebuttals</span></a></li><li><a href="carneades.database.db.html#var-get-statement"><span>get-statement</span></a></li><li><a href="carneades.database.db.html#var-get-undercutters"><span>get-undercutters</span></a></li><li><a href="carneades.database.db.html#var-list-argument-poll"><span>list-argument-poll</span></a></li><li><a href="carneades.database.db.html#var-list-arguments"><span>list-arguments</span></a></li><li><a href="carneades.database.db.html#var-list-metadata"><span>list-metadata</span></a></li><li><a href="carneades.database.db.html#var-list-namespaces"><span>list-namespaces</span></a></li><li><a href="carneades.database.db.html#var-list-premises"><span>list-premises</span></a></li><li><a href="carneades.database.db.html#var-list-statement-poll"><span>list-statement-poll</span></a></li><li><a href="carneades.database.db.html#var-list-statements"><span>list-statements</span></a></li><li><a href="carneades.database.db.html#var-list-translations"><span>list-translations</span></a></li><li><a href="carneades.database.db.html#var-main-issues"><span>main-issues</span></a></li><li><a href="carneades.database.db.html#var-make-database-connection"><span>make-database-connection</span></a></li><li><a href="carneades.database.db.html#var-premises-for-statement"><span>premises-for-statement</span></a></li><li><a href="carneades.database.db.html#var-read-argument"><span>read-argument</span></a></li><li><a href="carneades.database.db.html#var-read-argument-poll"><span>read-argument-poll</span></a></li><li><a href="carneades.database.db.html#var-read-metadata"><span>read-metadata</span></a></li><li><a href="carneades.database.db.html#var-read-namespace"><span>read-namespace</span></a></li><li><a href="carneades.database.db.html#var-read-poll-for-argument"><span>read-poll-for-argument</span></a></li><li><a href="carneades.database.db.html#var-read-poll-for-statement"><span>read-poll-for-statement</span></a></li><li><a href="carneades.database.db.html#var-read-premise"><span>read-premise</span></a></li><li><a href="carneades.database.db.html#var-read-statement"><span>read-statement</span></a></li><li><a href="carneades.database.db.html#var-read-statement-poll"><span>read-statement-poll</span></a></li><li><a href="carneades.database.db.html#var-read-translation"><span>read-translation</span></a></li><li><a href="carneades.database.db.html#var-statement-created%3F"><span>statement-created?</span></a></li><li><a href="carneades.database.db.html#var-statements-for-atom"><span>statements-for-atom</span></a></li><li><a href="carneades.database.db.html#var-test-db"><span>test-db</span></a></li><li><a href="carneades.database.db.html#var-update-argument"><span>update-argument</span></a></li><li><a href="carneades.database.db.html#var-update-argument-poll"><span>update-argument-poll</span></a></li><li><a href="carneades.database.db.html#var-update-metadata"><span>update-metadata</span></a></li><li><a href="carneades.database.db.html#var-update-namespace"><span>update-namespace</span></a></li><li><a href="carneades.database.db.html#var-update-premise"><span>update-premise</span></a></li><li><a href="carneades.database.db.html#var-update-statement"><span>update-statement</span></a></li><li><a href="carneades.database.db.html#var-update-statement-poll"><span>update-statement-poll</span></a></li><li><a href="carneades.database.db.html#var-update-translation"><span>update-translation</span></a></li></ul></div><div class="namespace-docs" id="content"><h2>carneades.database.db documentation</h2><pre class="doc">A database schema and CRUD functions for storing arguments 
persistently in a relational database.

Naming convention: get-x operations return ids; read-x operations 
return a structure with properties of an object.</pre><div class="public" id="var-assume"><h3>assume</h3><div class="usage"><code>(assume stmts)</code></div><pre class="doc">Assumes the given statements to be true in the database, unless they have
been assumed to be false, in which case their status is left unchanged.</pre></div><div class="public" id="var-create-argument"><h3>create-argument</h3><div class="usage"><code>(create-argument arg)</code></div><pre class="doc">Creates a one-step argument and inserts it into a database.  Returns
the id of the new argument.</pre></div><div class="public" id="var-create-argument-database"><h3>create-argument-database</h3><div class="usage"><code>(create-argument-database db-name root-username root-password metadata)</code></div><pre class="doc">Initialize the database by creating the tables. Metadata can be
provided to describe the debate being modeled in the database and
the creators of the model, among other information.
Returns true if the database is successul created and initialized</pre></div><div class="public" id="var-create-argument-poll"><h3>create-argument-poll</h3><div class="usage"><code>(create-argument-poll arg)</code></div><pre class="doc">Records votes for the given user, 
where the votes are a map from argument ids to real
numbers in the range 0.0 to 1.0. All other votes for 
this user, if any, are deleted.</pre></div><div class="public" id="var-create-metadata"><h3>create-metadata</h3><div class="usage"><code>(create-metadata metadata)</code></div><pre class="doc">Inserts a metadata structure into a database.  
Returns the id of the record in the database.</pre></div><div class="public" id="var-create-namespace"><h3>create-namespace</h3><div class="usage"><code>(create-namespace m)</code></div><pre class="doc">map -&gt; boolean
Creates a namespace record and inserts it into a database.  
Returns the prefix of the namespace, which serves as its key.</pre></div><div class="public" id="var-create-premise"><h3>create-premise</h3><div class="usage"><code>(create-premise premise &amp; [argid])</code></div><pre class="doc">Inserts a premise into a database.  
Returns the id of the premise record in the database.
Creates a statement for the literal of the premise if one
does not already exist in the database.</pre></div><div class="public" id="var-create-statement"><h3>create-statement</h3><div class="usage"><code>(create-statement literal)</code></div><pre class="doc">Creates and inserts a statement record in the database for the atom of the given
literal. Returns the id of the new statement record.</pre></div><div class="public" id="var-create-statement-poll"><h3>create-statement-poll</h3><div class="usage"><code>(create-statement-poll poll)</code></div><pre class="doc">Records votes for the given user, 
where the votes are a map from statement ids to real
numbers in the range 0.0 to 1.0. All other votes for 
this user, if any, are deleted.</pre></div><div class="public" id="var-create-translation"><h3>create-translation</h3><div class="usage"><code>(create-translation m)</code></div><pre class="doc">map -&gt; integer
Creates a translation record and inserts it into a database.  
Returns the id of the new translation.</pre></div><div class="public" id="var-delete-argument"><h3>delete-argument</h3><div class="usage"><code>(delete-argument id)</code></div><pre class="doc">Deletes an argument with the given the id.  The statements
of the conclusion and premises of the argument are not 
deleted. Returns true if successful.</pre></div><div class="public" id="var-delete-argument-poll"><h3>delete-argument-poll</h3><div class="usage"><code>(delete-argument-poll arg-id)</code></div><pre class="doc">Deletes all votes for the given argument id.
</pre></div><div class="public" id="var-delete-metadata"><h3>delete-metadata</h3><div class="usage"><code>(delete-metadata id)</code></div><pre class="doc">Deletes a metadata entry with the given the id. Returns true.
</pre></div><div class="public" id="var-delete-namespace"><h3>delete-namespace</h3><div class="usage"><code>(delete-namespace prefix)</code></div><pre class="doc">Deletes a translation with the given the prefix.
Returns true if successful.</pre></div><div class="public" id="var-delete-premise"><h3>delete-premise</h3><div class="usage"><code>(delete-premise id)</code></div><pre class="doc">Deletes a premise with the given the id
</pre></div><div class="public" id="var-delete-statement"><h3>delete-statement</h3><div class="usage"><code>(delete-statement id)</code></div><pre class="doc">Deletes a statement entry with the given the id. Returns true.
</pre></div><div class="public" id="var-delete-statement-poll"><h3>delete-statement-poll</h3><div class="usage"><code>(delete-statement-poll statement-id)</code></div><pre class="doc">Deletes all votes for the given statement id.
</pre></div><div class="public" id="var-delete-translation"><h3>delete-translation</h3><div class="usage"><code>(delete-translation id)</code></div><pre class="doc">Deletes a translation with the given the id
</pre></div><div class="public" id="var-get-con-arguments"><h3>get-con-arguments</h3><div class="usage"><code>(get-con-arguments stmt-id)</code></div><pre class="doc">Returns a sequence of the ids of arguments con
the statement with the given id.</pre></div><div class="public" id="var-get-dependents"><h3>get-dependents</h3><div class="usage"><code>(get-dependents arg-id)</code></div><pre class="doc">string -&gt; sequence of string
returns a sequence of argument ids in which the conclusion of the argument
with the given id is a premise</pre></div><div class="public" id="var-get-pro-arguments"><h3>get-pro-arguments</h3><div class="usage"><code>(get-pro-arguments stmt-id)</code></div><pre class="doc">Returns a sequence of the ids of arguments pro
the statement with the given id.</pre></div><div class="public" id="var-get-rebuttals"><h3>get-rebuttals</h3><div class="usage"><code>(get-rebuttals arg-id)</code></div><pre class="doc">string -&gt; sequence of string
Returns a sequence of ids of arguments which rebut
the argument with the given id.</pre></div><div class="public" id="var-get-statement"><h3>get-statement</h3><div class="usage"><code>(get-statement literal)</code></div><pre class="doc">literal -&gt; string
If a statement for the atom of the literal exists in the database,
or a statement for the id of the statement,
the id of the first matching statement is returned, otherwise a new
statement for the literal is first created and its id is
returned.</pre></div><div class="public" id="var-get-undercutters"><h3>get-undercutters</h3><div class="usage"><code>(get-undercutters arg-id)</code></div><pre class="doc">string -&gt; sequence of string
Returns a sequence of ids of arguments which undercut
the argument with the given id.</pre></div><div class="public" id="var-list-argument-poll"><h3>list-argument-poll</h3><div class="usage"><code>(list-argument-poll)</code></div><pre class="doc">Returns a sequence of maps representing the argument poll table in the database
</pre></div><div class="public" id="var-list-arguments"><h3>list-arguments</h3><div class="usage"><code>(list-arguments)</code></div><pre class="doc">Returns a sequence of all the argument records in the database
</pre></div><div class="public" id="var-list-metadata"><h3>list-metadata</h3><div class="usage"><code>(list-metadata)</code></div><pre class="doc">Returns a sequence of all the metadata records in the database
</pre></div><div class="public" id="var-list-namespaces"><h3>list-namespaces</h3><div class="usage"><code>(list-namespaces)</code></div><pre class="doc">Returns a sequence of maps representing the namespaces in the database
</pre></div><div class="public" id="var-list-premises"><h3>list-premises</h3><div class="usage"><code>(list-premises)</code></div><pre class="doc">Returns a sequence of all the premise records in the database
</pre></div><div class="public" id="var-list-statement-poll"><h3>list-statement-poll</h3><div class="usage"><code>(list-statement-poll)</code></div><pre class="doc">Returns a sequence of maps representing the statement poll table in the database
</pre></div><div class="public" id="var-list-statements"><h3>list-statements</h3><div class="usage"><code>(list-statements)</code></div><pre class="doc">Returns a sequence of all the statement records in the database
</pre></div><div class="public" id="var-list-translations"><h3>list-translations</h3><div class="usage"><code>(list-translations)</code></div><pre class="doc">Returns a sequence of all the translation records in the database
</pre></div><div class="public" id="var-main-issues"><h3>main-issues</h3><div class="usage"><code>(main-issues)</code></div><pre class="doc">Returns a sequence of statements that are main issues.
</pre></div><div class="public" id="var-make-database-connection"><h3>make-database-connection</h3><div class="usage"><code>(make-database-connection db-name username passwd &amp; options)</code></div><pre class="doc">Returns a map describing a database connection.
Available options are :host and :protocol.
If not specified they default to theirs values
in ~/.carneades.properties and if not specified there
to '$PWD/data/databases' and 'file' respectively.</pre></div><div class="public" id="var-premises-for-statement"><h3>premises-for-statement</h3><div class="usage"><code>(premises-for-statement id)</code></div><pre class="doc">Queries the database to find premises with this statement's id.
Returns a sequence of ids.</pre></div><div class="public" id="var-read-argument"><h3>read-argument</h3><div class="usage"><code>(read-argument id)</code></div><pre class="doc">string -&gt; argument or nil
Retrieves the argument with the given id from the database.
Returns nil if no argument with the given id exists in the
database. The resulting argument has additional properties
listing the ids of the rebuttals and undercutters of the argument.</pre></div><div class="public" id="var-read-argument-poll"><h3>read-argument-poll</h3><div class="usage"><code>(read-argument-poll id)</code></div><pre class="doc">Retrieves the poll with the given id from the database
</pre></div><div class="public" id="var-read-metadata"><h3>read-metadata</h3><div class="usage"><code>(read-metadata id)</code></div><pre class="doc">Retrieves the metadata with the given id from the database, 
and returns it as a metadata record. Returns nil if there
is no metadata record in the database with this id.</pre></div><div class="public" id="var-read-namespace"><h3>read-namespace</h3><div class="usage"><code>(read-namespace prefix)</code></div><pre class="doc">string -&gt; map or nil
Retrieves the namespace with the given prefix from the database.
Returns nil if no namespace with the given prefix exists in the
database.</pre></div><div class="public" id="var-read-poll-for-argument"><h3>read-poll-for-argument</h3><div class="usage"><code>(read-poll-for-argument arg-id)</code></div><pre class="doc">int -&gt; {:count x, :value y}
Returns the results of a poll for the argument
with the given id.  The results are
returned as a map with a count of the number of
votes and the average value of the votes.</pre></div><div class="public" id="var-read-poll-for-statement"><h3>read-poll-for-statement</h3><div class="usage"><code>(read-poll-for-statement statement-id)</code></div><pre class="doc">int -&gt; {:count x, :value y}
Returns the results of a poll for the statement
with the given id.  The results are
returned as a map with a count of the number of
votes and the average value of the votes.</pre></div><div class="public" id="var-read-premise"><h3>read-premise</h3><div class="usage"><code>(read-premise id)</code></div><pre class="doc">database integer -&gt; premise or nil
Retrieves the premise with the given id from the database.
Returns nil if no premise with the given id exists in the
database. The resulting premises has additional properties
listing the ids of the arguments pro and con the statement of
the premise.</pre></div><div class="public" id="var-read-statement"><h3>read-statement</h3><div class="usage"><code>(read-statement id)</code></div><pre class="doc">string -&gt; statement or nil
Retreives the statement with the give id from the database.
Returns nil if there is not statement with this id.</pre></div><div class="public" id="var-read-statement-poll"><h3>read-statement-poll</h3><div class="usage"><code>(read-statement-poll id)</code></div><pre class="doc">Retrieves the poll with the given id from the database
</pre></div><div class="public" id="var-read-translation"><h3>read-translation</h3><div class="usage"><code>(read-translation id)</code></div><pre class="doc">integer -&gt; map or nil
Retrieves the translation with the given id from the database.
Returns nil if no translation with the given id exists in the
database.</pre></div><div class="public" id="var-statement-created%3F"><h3>statement-created?</h3><div class="usage"><code>(statement-created? statement)</code></div><pre class="doc">Returns true if the statement has been created in the database
</pre></div><div class="public" id="var-statements-for-atom"><h3>statements-for-atom</h3><div class="usage"><code>(statements-for-atom atom)</code></div><pre class="doc">atom -&gt; sequence of strings
Queries the database to find statements with this
atom. Returns a sequence of the ids of the statements
found.</pre></div><div class="public" id="var-test-db"><h3>test-db</h3><div class="usage"><code>(test-db db &amp; body)</code></div><pre class="doc">For testing and development.  Doesn't do any 
any error handling so don't use in production code.</pre></div><div class="public" id="var-update-argument"><h3>update-argument</h3><div class="usage"><code>(update-argument id m)</code></div><pre class="doc">string map -&gt; boolean
Updates the argument with the given id in the database
with the values in the map. Returns true if the update
succeeds.</pre></div><div class="public" id="var-update-argument-poll"><h3>update-argument-poll</h3><div class="usage"><code>(update-argument-poll arg)</code></div><pre class="doc">database string map -&gt; boolean
Updates the votes of a user.  The map is
from argument ids to numbers in the range of 0.0 to 1.0.</pre></div><div class="public" id="var-update-metadata"><h3>update-metadata</h3><div class="usage"><code>(update-metadata id md)</code></div><pre class="doc">integer map -&gt; boolean
Updates the metadata record with the given id in the database with the values
in the map.  Returns true if the update was successful.</pre></div><div class="public" id="var-update-namespace"><h3>update-namespace</h3><div class="usage"><code>(update-namespace id m)</code></div><pre class="doc">integer map -&gt; boolean
Updates the namespace with the given id in the database
with the values in the map. Returns true if the update
succeeds.</pre></div><div class="public" id="var-update-premise"><h3>update-premise</h3><div class="usage"><code>(update-premise id m)</code></div><pre class="doc">integer map -&gt; boolean
Updates the premise with the given id in the database
with the values in the map. Returns true if the update
succeeds.</pre></div><div class="public" id="var-update-statement"><h3>update-statement</h3><div class="usage"><code>(update-statement id m)</code></div><pre class="doc">string map -&gt; boolean
Updates the statement record with the given id in the
database with the values in the map. Returns true if
the update was successful.</pre></div><div class="public" id="var-update-statement-poll"><h3>update-statement-poll</h3><div class="usage"><code>(update-statement-poll poll)</code></div><pre class="doc">string map -&gt; boolean
Updates the votes of a user.  The map is
from statement ids to numbers in the range of 0.0 to 1.0.</pre></div><div class="public" id="var-update-translation"><h3>update-translation</h3><div class="usage"><code>(update-translation id m)</code></div><pre class="doc">integer map -&gt; boolean
Updates the translation with the given id in the database
with the values in the map. Returns true if the update
succeeds.</pre></div></div></body></html>